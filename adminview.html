<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Response Manager (Custom Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./css/adminview.css">

    <!-- Authentication Check -->
    <script>
        // Check authentication before loading the admin panel
        window.addEventListener('load', () => {
            const currentUser = localStorage.getItem('currentUser');
            if (!currentUser) {
                window.location.href = 'index.html';
                return;
            }

            const user = JSON.parse(currentUser);
            if (user.status !== 'active') {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
                return;
            }

            // Check if user has admin privileges
            if (user.level !== 'leader' && user.level !== 'key') {
                alert('B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang qu·∫£n tr·ªã');
                window.location.href = 'dashboard-v2.html';
                return;
            }
        });
    </script>
</head>
<body class="transition-colors duration-300">

    <div id="app-container" class="max-w-screen-2xl mx-auto px-4 md:px-6 py-4 md:py-6 opacity-0 transition-opacity duration-500">
        <header class="relative flex justify-between items-center mb-6 pb-4 border-b border-[rgb(var(--color-border))]">
            <div class="text-left">
                <h1 class="text-3xl md:text-4xl font-bold text-[rgb(var(--color-text-secondary))]">Template Response Manager</h1>
                <p class="text-[rgb(var(--color-text-muted))] mt-2">Create, manage, and use response templates to improve workflow.</p>
            </div>
            <div class="flex items-center gap-2">
                <div id="sync-status" class="flex items-center gap-2 mr-4 text-sm text-[rgb(var(--color-text-muted))]">
                    <svg id="sync-icon-syncing" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h5M20 20v-5h-5M20 4v5h-5M4 20v-5h5"/></svg>
                    <svg id="sync-icon-success" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500 hidden" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                     <svg id="sync-icon-error" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-red-500 hidden" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" /></svg>
                    <span id="sync-text">Syncing...</span>
                </div>
                <div id="theme-switcher" class="flex items-center gap-1 bg-[rgb(var(--color-bg-secondary))] p-1 rounded-full">
                    <button data-theme="light" class="theme-btn p-2 rounded-full" title="Light Theme"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg></button>
                    <button data-theme="yellow" class="theme-btn p-2 rounded-full" title="Yellow Theme"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" /></svg></button>
                    <button data-theme="dark" class="theme-btn p-2 rounded-full" title="Dark Theme"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg></button>
                </div>
                <button id="open-help-btn" class="p-3 bg-[rgb(var(--color-bg-secondary))] hover:bg-[rgb(var(--color-bg-tertiary))] rounded-full transition-colors" title="Tr·ª£ gi√∫p & H∆∞·ªõng d·∫´n"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[rgb(var(--color-text-secondary))]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.546-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg></button>
                <button id="open-data-manager-btn" class="p-3 bg-[rgb(var(--color-bg-secondary))] hover:bg-[rgb(var(--color-bg-tertiary))] rounded-full transition-colors" title="C√†i ƒë·∫∑t & Qu·∫£n l√Ω D·ªØ li·ªáu"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[rgb(var(--color-text-secondary))]" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 0118 0z" /></svg></button>
            </div>
        </header>

        <!-- Admin Navigation -->
        <nav class="bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-md mb-6">
            <div class="flex flex-wrap justify-center gap-2 p-4">
                <button id="nav-work-schedule" class="nav-btn px-4 py-2 bg-orange-500 hover:bg-orange-600 text-white rounded-lg transition-colors">
                    üìÖ Manual Schedule Pickup
                </button>
                <button id="nav-template-management" class="nav-btn px-4 py-2 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors">
                    üìù Templates
                </button>
                <button id="nav-dashboard-link" class="nav-btn px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                    üè† Back to Dashboard
                </button>
            </div>
        </nav>

        <main class="bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-md min-h-[80vh]">
            <!-- Account Management Section -->
            <div id="section-account-management" class="admin-section hidden p-6">
                <h2 class="text-2xl font-bold mb-6 text-[rgb(var(--color-text-secondary))]">üë• Account Management</h2>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- User List -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-semibold">User Accounts</h3>
                            <button id="create-user-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg">
                                ‚ûï Create User
                            </button>
                        </div>
                        <div id="users-list" class="space-y-2 max-h-96 overflow-y-auto">
                            <!-- Users will be populated here -->
                        </div>
                    </div>

                    <!-- User Details/Edit Form -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">User Details</h3>
                        <div id="user-details-form">
                            <p class="text-gray-500">Select a user to view/edit details</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Human Resources Section -->
            <div id="section-human-resources" class="admin-section hidden p-6">
                <h2 class="text-2xl font-bold mb-6 text-[rgb(var(--color-text-secondary))]">üè¢ Human Resources</h2>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Member Management -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Member Management</h3>
                        <div id="members-list" class="space-y-2 max-h-64 overflow-y-auto">
                            <!-- Members will be populated here -->
                        </div>
                    </div>

                    <!-- KPI Dashboard -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">KPI Overview</h3>
                        <div id="kpi-dashboard">
                            <!-- KPI data will be populated here -->
                        </div>
                    </div>

                    <!-- Performance Metrics -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Performance Metrics</h3>
                        <div id="performance-metrics">
                            <!-- Performance data will be populated here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Template Management Section -->
            <div id="section-template-management" class="admin-section p-6">
                <h2 class="text-2xl font-bold mb-6 text-[rgb(var(--color-text-secondary))]">üìù Template Management</h2>

                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                    <!-- Projects & Categories -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg flex flex-col">
                        <div class="mb-4">
                            <h3 class="text-lg font-semibold mb-2">Projects</h3>
                            <div id="project-tabs-container" class="flex flex-wrap gap-2"></div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-[rgb(var(--color-border))]">
                            <div class="flex justify-between items-center">
                                <h4 class="text-sm font-semibold text-[rgb(var(--color-text-muted))]">Current Signer:</h4>
                                <button id="change-signer-btn" class="text-xs text-[rgb(var(--color-accent-primary))] hover:underline">Change</button>
                            </div>
                            <p id="current-signer-display" class="font-bold text-lg text-[rgb(var(--color-accent-primary))]">Loading...</p>
                        </div>
                        <h3 class="text-lg font-semibold mb-2 mt-4">Categories</h3>
                        <div id="issues-list" class="space-y-1 flex-grow h-[40vh] overflow-y-auto pr-2"></div>
                    </div>

                    <!-- Template List -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg flex flex-col">
                        <div class="flex flex-col sm:flex-row justify-between items-center mb-4 gap-2">
                            <h3 class="text-lg font-semibold">Templates</h3>
                            <button id="new-template-btn" class="w-full sm:w-auto bg-[rgb(var(--color-accent-primary))] hover:bg-[rgb(var(--color-accent-primary-hover))] text-white font-bold py-2 px-4 rounded-lg transition-colors">Create New</button>
                        </div>
                        <input type="text" id="search-input" placeholder="Search templates..." class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent-primary))] bg-[rgb(var(--color-bg-primary))]">
                        <div id="template-list" class="space-y-2 flex-grow h-[50vh] overflow-y-auto pr-2"></div>
                    </div>

                    <!-- Template Workspace -->
                    <div class="lg:col-span-2 bg-[rgb(var(--color-bg-secondary))] p-6 rounded-lg min-h-[60vh]">
                        <div id="workspace">
                    <div id="welcome-screen" class="flex flex-col items-center justify-center h-full text-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 text-[rgb(var(--color-text-muted))] mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>
                        <h3 class="text-2xl font-semibold text-[rgb(var(--color-text-secondary))]">Welcome!</h3>
                        <p class="text-[rgb(var(--color-text-muted))] mt-2">Select a template from the list to start editing or using it.</p>
                    </div>

                    <!-- Template Editor Form (English UI) -->
                    <div id="template-form" class="hidden">
                        <h3 id="form-title" class="text-2xl font-bold mb-4">Create New Template</h3>
                        <form id="editor-form" class="space-y-4">
                            <input type="hidden" id="template-id">
                            <div>
                                <label for="main-issue" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))] mb-1">Main Issue (Category)</label>
                                <input type="text" id="main-issue" list="existing-issues" required class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent-primary))] bg-[rgb(var(--color-bg-primary))]" placeholder="Select or type a new category...">
                                <datalist id="existing-issues"></datalist>
                            </div>
                            <div>
                                <label for="template-name" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))] mb-1">Template Name</label>
                                <input type="text" id="template-name" required class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" placeholder="e.g., Reply to quote for product A">
                            </div>
                            <div>
                                <label for="template-description" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))] mb-1">Description</label>
                                <textarea id="template-description" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" rows="3" placeholder="Explain when and how to use this template..."></textarea>
                            </div>
                            <div id="sop-link-field" class="hidden">
                                <label for="sop-link" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))] mb-1">SOP Link (for POS tasks)</label>
                                <input type="url" id="sop-link" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" placeholder="https://docs.google.com/document/...">
                                <p class="text-xs text-[rgb(var(--color-text-muted))] mt-1">Add a link to the Standard Operating Procedure document for this POS task</p>
                            </div>

                            <!-- WDN Template Builder (Supplier Email) - Primary interface for WDN projects -->
                            <div id="wdn-template-builder" class="hidden space-y-4 p-4 border-2 border-cyan-400 bg-cyan-50 rounded-lg">
                                <h4 class="font-semibold text-cyan-800 text-lg flex items-center gap-2">
                                    <span>üìß</span> Supplier Email Template Builder
                                </h4>
                                <p class="text-xs text-gray-600">Use placeholders: <code class="placeholder-tag">{{Supplier_Name}}</code>, <code class="placeholder-tag">{{Order_Number}}</code>, <code class="placeholder-tag">{{Brand}}</code></p>

                                <div class="p-3 bg-amber-50 border border-amber-300 rounded-lg">
                                    <label for="wdn-email-from" class="block text-sm font-medium text-amber-800 mb-1">‚ö†Ô∏è Email From <span class="text-amber-600 font-normal">(reminder - send from this account)</span></label>
                                    <input type="text" id="wdn-email-from" class="w-full p-2 border border-amber-300 rounded-lg bg-white" placeholder="e.g., wdn-team@company.com">
                                    <p class="text-xs text-amber-600 mt-1">Make sure you are sending from the correct email account!</p>
                                </div>

                                <div>
                                    <label for="wdn-subject" class="block text-sm font-medium text-gray-700 mb-1">Subject Line</label>
                                    <input type="text" id="wdn-subject" class="w-full p-2 border border-gray-300 rounded-lg bg-white" placeholder="RE: {{Brand}} Order #{{Order_Number}} - Update Required">
                                </div>

                                <div>
                                    <label for="wdn-cc" class="block text-sm font-medium text-gray-700 mb-1">CC Recipients <span class="text-gray-400 font-normal">(optional, comma-separated)</span></label>
                                    <input type="text" id="wdn-cc" class="w-full p-2 border border-gray-300 rounded-lg bg-white" placeholder="team@example.com, manager@example.com">
                                </div>

                                <div>
                                    <label for="wdn-email-body" class="block text-sm font-medium text-gray-700 mb-1">Email Body <span class="text-cyan-600 font-normal">(main content)</span></label>
                                    <div class="flex gap-4">
                                        <textarea id="wdn-email-body" rows="14" class="w-full p-2 border border-gray-300 rounded-lg bg-white focus:outline-none focus:ring-2 focus:ring-cyan-400" placeholder="Hello {{Supplier_Name}},

I am reaching out regarding order #{{Order_Number}} for {{Brand}}.

[Your email content here...]

Best regards,"></textarea>
                                        <div id="wdn-component-panel" class="w-48 flex-shrink-0">
                                            <h4 class="font-semibold mb-2 text-sm text-center text-gray-600">Components</h4>
                                            <div id="wdn-component-source" class="space-y-2"></div>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label for="wdn-internal-note" class="block text-sm font-medium text-gray-700 mb-1">Internal Note <span class="text-gray-400 font-normal">(optional - added to ticket)</span></label>
                                    <textarea id="wdn-internal-note" rows="3" class="w-full p-2 border border-gray-300 rounded-lg bg-white" placeholder="Internal note for the ticket (not sent to supplier)..."></textarea>
                                </div>
                            </div>

                            <!-- Supplier Template Builder - Primary interface for non-WDN projects -->
                            <div id="supplier-template-builder">
                                <label id="main-content-label" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))] mb-1">Main Content (for Supplier)</label>
                                <div class="flex gap-4">
                                    <textarea id="template-content-textarea" rows="12" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))] focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent-primary))]"></textarea>
                                    <div id="component-panel" class="w-48 flex-shrink-0">
                                        <h4 class="font-semibold mb-2 text-sm text-center text-[rgb(var(--color-text-secondary))]">Components</h4>
                                        <div id="component-source" class="space-y-2"></div>
                                    </div>
                                </div>
                            </div>
                             <div id="checkbox-row-customer-footer" class="flex flex-col sm:flex-row sm:items-center gap-4">
                                <label id="send-to-customer-label" class="flex items-center"><input type="checkbox" id="send-to-customer" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Send email to Customer</span></label>
                                <label class="flex items-center"><input type="checkbox" id="include-footer" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Include Footer</span></label>
                            </div>
                            <div>
                                <label class="flex items-center"><input type="checkbox" id="add-label-reminder" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Add Label Reminder</span></label>
                                <input type="text" id="label-name" class="hidden mt-2 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" placeholder="Enter the label name for the reminder...">
                            </div>
                            <div>
                                <label class="flex items-center"><input type="checkbox" id="add-optional-field" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Add optional fields (visible on use)</span></label>
                                <input type="text" id="optional-field-name" class="hidden mt-2 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" placeholder="Enter field names, separated by a comma. e.g., Tracking_Number, Invoice_ID">
                            </div>
                             <div>
                                <label class="flex items-center"><input type="checkbox" id="add-follow-up" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Add Required Follow-up Steps</span></label>
                            </div>
                            <div class="flex flex-col sm:flex-row sm:items-center gap-4">
                                <label class="flex items-center"><input type="checkbox" id="need-greeting" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded" checked><span class="ml-2 text-sm">Include opening greeting</span></label>
                                <label class="flex items-center"><input type="checkbox" id="email-carrier" class="h-4 w-4 text-[rgb(var(--color-accent-primary))] border-[rgb(var(--color-border))] rounded"><span class="ml-2 text-sm">Require Email to Carrier (FMOP)</span></label>
                            </div>
                            <div id="customer-template-fields" class="hidden p-4 border-l-4 border-rose-400 bg-rose-50 space-y-4">
                                <h4 class="font-semibold text-rose-800">Customer Email Content</h4>
                                <p class="text-xs text-gray-600">Use: <code class="placeholder-tag">{{Customer_Name}}</code>, <code class="placeholder-tag">{{Order_Number}}</code>, <code class="placeholder-tag">{{Brand}}</code></p>
                                <div>
                                    <label for="customer-subject" class="block text-sm font-medium text-gray-700 mb-1">Customer Email Subject</label>
                                    <input type="text" id="customer-subject" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Information On Your {{Brand}} Order #{{Order_Number}}">
                                </div>
                                <div>
                                    <label for="customer-cc" class="block text-sm font-medium text-gray-700 mb-1">CC Recipients <span class="text-gray-400 font-normal">(optional, comma-separated)</span></label>
                                    <input type="text" id="customer-cc" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="team@example.com, manager@example.com">
                                </div>
                                <div>
                                    <label for="customer-body" class="block text-sm font-medium text-gray-700 mb-1">Customer Email Body</label>
                                    <textarea id="customer-body" rows="6" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Hello {{Customer_Name}},..."></textarea>
                                </div>
                            </div>
                            <div id="carrier-email-fields" class="hidden p-4 border-l-4 border-orange-400 bg-orange-50 space-y-4">
                                <h4 class="font-semibold text-orange-800">Carrier Email Content (FMOP)</h4>
                                <p class="text-xs text-gray-600">Use: <code class="placeholder-tag">{{carrier}}</code>, <code class="placeholder-tag">{{ticket}}</code> placeholders</p>
                                <div>
                                    <label for="carrier-email-subject" class="block text-sm font-medium text-gray-700 mb-1">Carrier Email Subject</label>
                                    <input type="text" id="carrier-email-subject" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="{{ticket}} - Pickup Request PO {{PO}}">
                                </div>
                                <div>
                                    <label for="bol-naming-method" class="block text-sm font-medium text-gray-700 mb-1">BOL File Naming Method</label>
                                    <input type="text" id="bol-naming-method" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="today_{{PO}}_{{carrier_name}}">
                                </div>
                            </div>
                            <div id="internal-comment-fields" class="hidden p-4 border-l-4 border-gray-400 bg-gray-50 space-y-4">
                                <label class="flex items-center"><input type="checkbox" id="add-internal-comment" class="h-4 w-4 text-gray-600 border-gray-300 rounded"><span class="ml-2 text-sm">Add internal comment (for 'Movement' only)</span></label>
                                <div id="internal-comment-input-container" class="hidden">
                                    <h4 class="font-semibold text-gray-800">Internal Comment Content</h4>
                                    <textarea id="internal-comment-body" rows="6" class="w-full p-2 border border-gray-300 rounded-lg mt-2" placeholder="e.g., Transfer this ticket to the FMOP team for handling..."></textarea>
                                </div>
                            </div>
                            
                            <div id="movement-guide-editor" class="hidden p-4 border-l-4 border-purple-400 bg-purple-50 space-y-4">
                                <h4 class="font-semibold text-purple-800 text-lg">Setup Ticket Movement Guide</h4>
                                <p class="text-xs text-gray-600">Only applies when the Main Issue is 'Movement'.</p>
                                <div id="movement-guide-steps-container" class="space-y-3"></div>
                                <button type="button" id="add-movement-step-btn" class="mt-3 text-sm bg-blue-100 hover:bg-blue-200 text-blue-800 font-semibold py-1 px-3 rounded-md">+ Add Step</button>
                            </div>

                            <div id="follow-up-guide-editor" class="hidden p-4 border-l-4 border-cyan-400 bg-cyan-50 space-y-4">
                                <h4 class="font-semibold text-cyan-800 text-lg">Setup Required Follow-up Steps</h4>
                                <div id="follow-up-guide-steps-container" class="space-y-3"></div>
                                <button type="button" id="add-follow-up-step-btn" class="mt-3 text-sm bg-blue-100 hover:bg-blue-200 text-blue-800 font-semibold py-1 px-3 rounded-md">+ Add Step</button>
                            </div>

                            <div class="flex justify-end gap-3 pt-4">
                                <button type="button" id="cancel-btn" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">Cancel</button>
                                <button type="submit" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Save Template</button>
                            </div>
                        </form>
                    </div>

                    <!-- Template Viewer (Vietnamese UI) -->
                    <div id="template-viewer" class="hidden">
                        <h3 id="viewer-title" class="text-2xl font-bold mb-2"></h3>
                        <div class="flex justify-between items-center text-sm text-[rgb(var(--color-text-muted))] mb-2">
                            <p id="viewer-category"></p>
                            <p id="viewer-updated-date" class="font-medium"></p>
                        </div>
                        <p id="viewer-description" class="mb-4 p-3 bg-[rgba(var(--color-accent-primary),0.05)] border-l-4 border-[rgba(var(--color-accent-primary),0.3)] text-sm hidden"></p>
                        
                        <div class="mb-4 p-4 bg-[rgb(var(--color-bg-accent))] border border-[rgba(var(--color-accent-primary),0.3)] rounded-lg space-y-4">
                            <div>
                                <h4 class="font-semibold text-lg mb-2 text-[rgb(var(--color-accent-primary))]">1. Th√¥ng tin Ng∆∞·ªùi nh·∫≠n & Ng∆∞·ªùi g·ª≠i</h4>
                                <div class="space-y-3 pl-2">
                                    <h5 class="font-medium">L·ªùi ch√†o</h5>
                                    <div>
                                        <label for="viewer-agent-name" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))]">T√™n Nh√¢n vi√™n (∆Øu ti√™n cao nh·∫•t)</label>
                                        <input type="text" id="viewer-agent-name" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                                    </div>
                                    <div>
                                        <label for="viewer-su-id" class="block text-sm font-medium text-[rgb(var(--color-text-secondary))]">M√£ Nh√† Cung C·∫•p (SuID / Child SuID)</label>
                                        <input type="text" id="viewer-su-id" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]" placeholder="Nh·∫≠p SuID ƒë·ªÉ tra c·ª©u t√™n...">
                                    </div>
                                    <div id="viewer-manual-supplier-container" class="hidden">
                                        <label for="viewer-manual-supplier-name" class="block text-sm font-medium text-red-700">Kh√¥ng t√¨m th·∫•y ID, vui l√≤ng nh·∫≠p t√™n NCC</label>
                                        <input type="text" id="viewer-manual-supplier-name" class="mt-1 w-full p-2 border border-red-400 rounded-md bg-[rgb(var(--color-bg-primary))]" placeholder="B·∫Øt bu·ªôc nh·∫≠p t√™n nh√† cung c·∫•p">
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold text-lg mb-2 text-[rgb(var(--color-accent-primary))]">2. T√πy ch·ªânh N·ªôi dung ch√≠nh</h4>
                                <div id="placeholders-container" class="space-y-4 pl-2"></div>
                                <div id="optionals-container" class="mt-4 space-y-2 pl-2"></div>
                                <div id="dynamic-optional-field-container" class="mt-4 space-y-3 pl-2"></div>
                            </div>
                        </div>

                        <div class="mt-6">
                            <div class="flex justify-between items-center mb-2">
                                <h4 class="font-semibold text-lg">N·ªôi dung cu·ªëi c√πng</h4>
                                <div class="flex items-center gap-2">
                                     <button id="show-follow-up-guide-btn" class="hidden bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" /></svg>
                                        Xem Follow-up
                                    </button>
                                     <button id="show-movement-guide-btn" class="hidden bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
                                        Xem Quy tr√¨nh Move
                                    </button>
                                    <button id="copy-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg>
                                        Sao ch√©p & Ti·∫øp t·ª•c
                                    </button>
                                </div>
                            </div>
                            <div id="final-output" class="w-full p-4 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-secondary))] min-h-[250px] whitespace-pre-wrap"></div>
                        </div>
                         <div id="copy-feedback" class="mt-2 text-green-600 font-medium opacity-0 transition-opacity duration-300">ƒê√£ sao ch√©p v√†o clipboard!</div>
                    </div>
                </div>
                    </div>
                </div>
            </div>

            <!-- Work Schedule Section -->
            <div id="section-work-schedule" class="admin-section hidden p-6">
                <h2 class="text-2xl font-bold mb-6 text-[rgb(var(--color-text-secondary))]">üìÖ Work Schedule Management</h2>

                <!-- Rotation Lists Setup -->
                <div class="bg-[rgb(var(--color-bg-secondary))] p-6 rounded-lg mb-6">
                    <h3 class="text-xl font-bold mb-2 text-[rgb(var(--color-accent-primary))]">üìã Rotation Lists Setup</h3>
                    <p class="text-sm text-gray-600 mb-4">Configure which agents and accounts participate in the rotation. They cycle independently.</p>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Agent Rotation List -->
                        <div class="bg-white p-4 rounded-lg border-2 border-blue-200">
                            <h4 class="text-lg font-semibold mb-2 text-blue-700">üë• Agent Rotation List</h4>
                            <p class="text-xs text-gray-600 mb-3">Agents will be assigned in order from top to bottom, cycling back to the top.</p>

                            <div class="space-y-3">
                                <div class="flex gap-2">
                                    <select id="agent-select" class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                                        <option value="">Select an agent...</option>
                                    </select>
                                    <button id="add-agent-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg whitespace-nowrap text-sm font-medium">
                                        + Add
                                    </button>
                                </div>

                                <div id="agent-rotation-list" class="space-y-2 max-h-64 overflow-y-auto bg-gray-50 p-3 rounded border">
                                    <p class="text-xs text-gray-500 text-center py-4">No agents in rotation list</p>
                                </div>
                            </div>
                        </div>

                        <!-- Account Rotation List -->
                        <div class="bg-white p-4 rounded-lg border-2 border-green-200">
                            <h4 class="text-lg font-semibold mb-2 text-green-700">üè¢ Account Rotation List</h4>
                            <p class="text-xs text-gray-600 mb-3">Accounts will be assigned in order from top to bottom, cycling back to the top.</p>

                            <div class="space-y-3">
                                <div class="flex gap-2">
                                    <select id="account-select" class="flex-1 p-2 border border-gray-300 rounded-lg text-sm">
                                        <option value="">Select an account...</option>
                                    </select>
                                    <button id="add-account-btn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg whitespace-nowrap text-sm font-medium">
                                        + Add
                                    </button>
                                </div>

                                <div id="account-rotation-list" class="space-y-2 max-h-64 overflow-y-auto bg-gray-50 p-3 rounded border">
                                    <p class="text-xs text-gray-500 text-center py-4">No accounts in rotation list</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Manual Reschedule POs Assignment -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Manual Reschedule POs Assignment</h3>

                        <div class="space-y-4">
                            <!-- Assignment Type -->
                            <div>
                                <label class="block text-sm font-medium mb-2">Assignment Type</label>
                                <div class="flex gap-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="assignment-type" value="manual" class="mr-2" checked>
                                        Manual Assignment
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="assignment-type" value="auto" class="mr-2">
                                        Auto Assignment
                                    </label>
                                </div>
                            </div>

                            <!-- Manual Assignment -->
                            <div id="manual-assignment" class="space-y-3">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                    <div>
                                        <label for="select-member" class="block text-sm font-medium mb-1">Select Member</label>
                                        <select id="select-member" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                                            <option value="">Choose a member...</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="select-account" class="block text-sm font-medium mb-1">Select Account</label>
                                        <select id="select-account" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                                            <option value="">Choose an account...</option>
                                        </select>
                                    </div>
                                </div>

                                <!-- Date Selection -->
                                <div>
                                    <label class="block text-sm font-medium mb-2">Assignment Dates</label>
                                    <div class="space-y-2">
                                        <label class="flex items-center">
                                            <input type="radio" name="date-option" value="single" class="mr-2" checked>
                                            Single Day Assignment
                                        </label>
                                        <label class="flex items-center">
                                            <input type="radio" name="date-option" value="week" class="mr-2">
                                            Full Week Assignment (5 days)
                                        </label>
                                        <label class="flex items-center">
                                            <input type="radio" name="date-option" value="custom" class="mr-2">
                                            Custom Date Range
                                        </label>
                                    </div>
                                </div>

                                <!-- Date Inputs -->
                                <div id="single-date-input" class="space-y-2">
                                    <label for="assignment-date" class="block text-sm font-medium">Assignment Date</label>
                                    <input type="date" id="assignment-date" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                                </div>

                                <div id="custom-date-inputs" class="space-y-2 hidden">
                                    <div class="grid grid-cols-2 gap-2">
                                        <div>
                                            <label for="start-date" class="block text-sm font-medium">Start Date</label>
                                            <input type="date" id="start-date" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                                        </div>
                                        <div>
                                            <label for="end-date" class="block text-sm font-medium">End Date</label>
                                            <input type="date" id="end-date" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                                        </div>
                                    </div>
                                </div>

                                <!-- Assignment Preview -->
                                <div id="manual-assignment-preview" class="hidden bg-blue-50 border border-blue-200 rounded p-3">
                                    <h5 class="font-medium text-sm mb-2">Assignment Preview</h5>
                                    <div id="manual-preview-content" class="text-sm text-gray-700"></div>
                                </div>

                                <div class="flex gap-2">
                                    <button id="preview-manual-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg">
                                        Preview Assignment
                                    </button>
                                    <button id="assign-manual-btn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                        Confirm Assignment
                                    </button>
                                </div>
                            </div>

                            <!-- Auto Assignment Settings -->
                            <div id="auto-assignment" class="space-y-3 hidden">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Auto Assignment Schedule</label>
                                    <p class="text-sm text-gray-600 mb-2">Daily at 8:28 AM (Monday to Friday)</p>
                                    <label class="flex items-center mb-3">
                                        <input type="checkbox" id="enable-auto-assignment" class="mr-2">
                                        Enable Auto Assignment
                                    </label>

                                    <!-- Assignment Type Selection -->
                                    <div class="space-y-2 mb-3">
                                        <label class="block text-sm font-medium">Assignment Type</label>
                                        <div class="space-y-1">
                                            <label class="flex items-center">
                                                <input type="radio" name="auto-assignment-type" value="daily" class="mr-2" checked>
                                                Daily Assignment (1 weekday at a time)
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="auto-assignment-type" value="weekly" class="mr-2">
                                                Weekly Assignment (5 weekdays at once)
                                            </label>
                                            <label class="flex items-center">
                                                <input type="radio" name="auto-assignment-type" value="monthly" class="mr-2">
                                                Monthly Assignment (30 weekdays at once)
                                            </label>
                                        </div>
                                    </div>

                                    <!-- Auto Assignment Preview -->
                                    <div class="border border-gray-300 rounded-lg p-3 bg-gray-50">
                                        <h4 class="font-medium text-sm mb-2">Smart Auto Assignment</h4>
                                        <p class="text-xs text-gray-600 mb-2">Automatically pairs agents with accounts in sequence. Agents and accounts cycle independently.</p>
                                        <button id="preview-auto-assignment" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm mb-2">
                                            Show Preview
                                        </button>
                                        <div id="auto-assignment-preview" class="hidden">
                                            <div id="preview-content" class="text-sm text-gray-700 mb-2"></div>
                                            <div class="flex gap-2">
                                                <button id="confirm-auto-assignment" class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">
                                                    Confirm & Assign
                                                </button>
                                                <button id="cancel-auto-assignment" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm">
                                                    Cancel
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Current Assignments & Schedule -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Current Assignments</h3>

                        <div id="current-assignments" class="space-y-3">
                            <!-- Assignments will be populated here -->
                        </div>

                        <div class="mt-6">
                            <h4 class="text-md font-semibold mb-3">Assignment History</h4>
                            <div id="assignment-history" class="max-h-64 overflow-y-auto space-y-2">
                                <!-- History will be populated here -->
                            </div>
                        </div>

                        <div class="mt-6">
                            <h4 class="text-md font-semibold mb-3">Assignment Calendar</h4>
                            <div class="bg-white p-4 rounded-lg border">
                                <div class="flex justify-between items-center mb-4">
                                    <button id="prev-month-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded">
                                        ‚Üê Previous Month
                                    </button>
                                    <h5 id="calendar-month-title" class="font-semibold text-lg"></h5>
                                    <button id="next-month-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded">
                                        Next Month ‚Üí
                                    </button>
                                </div>
                                <div id="assignment-calendar" class="grid grid-cols-7 gap-2">
                                    <!-- Calendar will be populated here -->
                                </div>
                            </div>
                        </div>


                    </div>
                </div>

                <!-- Member & Account Lists -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Registered Members</h3>
                        <div id="registered-members-list" class="space-y-2 max-h-48 overflow-y-auto">
                            <!-- Members list will be populated here -->
                        </div>
                    </div>

                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h3 class="text-lg font-semibold mb-4">Available Accounts</h3>
                        <div id="available-accounts-list" class="space-y-2 max-h-48 overflow-y-auto">
                            <!-- Accounts list will be populated here -->
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- MODALS SECTION -->
    <div id="notification-toast" class="fixed bottom-5 right-5 bg-gray-800 text-white py-2 px-4 rounded-lg shadow-lg opacity-0 translate-y-4 transition-all duration-300 z-50"></div>

    <div id="data-manager-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-30">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-5xl h-[90vh] p-6 transform scale-95 flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">C√†i ƒë·∫∑t & Qu·∫£n l√Ω D·ªØ li·ªáu</h2>
                <button id="close-data-manager-btn" class="p-2 rounded-full hover:bg-[rgb(var(--color-bg-secondary))]">&times;</button>
            </div>
            <div class="border-b border-[rgb(var(--color-border))]">
                <nav class="-mb-px flex space-x-6" id="data-manager-tabs">
                    <button data-tab="snippets" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">N·ªôi dung & Snippets</button>
                    <button data-tab="projects" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">D·ª± √°n</button>
                    <button data-tab="templates" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">M·∫´u tr·∫£ l·ªùi</button>
                    <button data-tab="signatures" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">Ch·ªØ k√Ω</button>
                    <button data-tab="placeholders" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">Placeholders</button>
                    <button data-tab="suppliers" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">D·ªØ li·ªáu NCC</button>
                    <button data-tab="users" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">Qu·∫£n l√Ω User</button>
                    <button data-tab="kpi" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">Qu·∫£n l√Ω KPI</button>
                    <button data-tab="account" class="tab-button py-3 px-1 border-b-2 font-medium text-sm text-[rgb(var(--color-text-muted))] hover:text-[rgb(var(--color-text-secondary))] hover:border-[rgb(var(--color-border))]">D·ªØ li·ªáu</button>
                </nav>
            </div>
            <div class="flex-grow overflow-y-auto pt-4">
                <div id="tab-content-snippets" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Ch·ªânh s·ª≠a c√°c ƒëo·∫°n vƒÉn b·∫£n d√πng chung trong ·ª©ng d·ª•ng.</p>
                    <div class="space-y-4">
                        <div>
                            <label for="footer-text-input" class="font-semibold block mb-1">N·ªôi dung Ch√¢n trang</label>
                            <div class="mb-2">
                                <div class="flex gap-2 mb-2">
                                    <button type="button" id="footer-bold-btn" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm font-bold" title="Bold">B</button>
                                    <button type="button" id="footer-italic-btn" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm italic" title="Italic">I</button>
                                    <button type="button" id="footer-underline-btn" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm underline" title="Underline">U</button>
                                    <button type="button" id="footer-linebreak-btn" class="px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm" title="Line Break">‚Üµ</button>
                                </div>
                                <p class="text-xs text-[rgb(var(--color-text-muted))] mb-1">Use formatting buttons or HTML tags: &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italic&lt;/i&gt;, &lt;u&gt;underline&lt;/u&gt;, &lt;br&gt; for line breaks</p>
                            </div>
                            <textarea id="footer-text-input" rows="4" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]"></textarea>
                        </div>
                        <div>
                            <label for="greeting-person-input" class="font-semibold block mb-1">M·∫´u l·ªùi ch√†o (C√° nh√¢n)</label>
                            <p class="text-xs text-[rgb(var(--color-text-muted))] mb-1">D√πng <code>{{name}}</code> ƒë·ªÉ ch√®n t√™n.</p>
                            <input type="text" id="greeting-person-input" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                        </div>
                        <div>
                            <label for="greeting-team-input" class="font-semibold block mb-1">M·∫´u l·ªùi ch√†o (Nh√≥m)</label>
                            <p class="text-xs text-[rgb(var(--color-text-muted))] mb-1">D√πng <code>{{name}}</code> ƒë·ªÉ ch√®n t√™n.</p>
                            <input type="text" id="greeting-team-input" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                        </div>
                        <button id="save-snippets-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">L∆∞u Snippets</button>
                    </div>
                </div>
                <div id="tab-content-projects" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω c√°c d·ª± √°n ch√≠nh.</p>
                    <div class="flex gap-2 mb-4">
                        <button data-store="projects" class="export-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Xu·∫•t (JSON)</button>
                        <label class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer">Nh·∫≠p (JSON)<input type="file" data-store="projects" class="import-file-input hidden" accept=".json"></label>
                    </div>
                    <div class="mb-4 p-3 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-secondary))]">
                        <h4 class="font-semibold mb-2">Th√™m d·ª± √°n m·ªõi</h4>
                        <div class="flex gap-2">
                            <input type="text" id="new-project-name" placeholder="T√™n d·ª± √°n (v√≠ d·ª•: RPOPS)" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                            <button id="add-project-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg">Th√™m</button>
                        </div>
                    </div>
                    <div id="projects-table" class="text-sm"></div>
                </div>
                <div id="tab-content-templates" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω t·∫•t c·∫£ c√°c m·∫´u tr·∫£ l·ªùi.</p>
                    <div class="flex gap-2 mb-4">
                        <button data-store="templates" class="export-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Xu·∫•t (JSON)</button>
                        <label class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer">Nh·∫≠p (JSON)<input type="file" data-store="templates" class="import-file-input hidden" accept=".json"></label>
                    </div>
                    <div id="templates-table" class="text-sm"></div>
                </div>
                <div id="tab-content-signatures" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω ch·ªØ k√Ω c√° nh√¢n. Ch·ªØ k√Ω ƒë∆∞·ª£c ƒë√°nh d·∫•u 'M·∫∑c ƒë·ªãnh' s·∫Ω ƒë∆∞·ª£c ch·ªçn t·ª± ƒë·ªông.</p>
                     <div class="flex gap-2 mb-4">
                        <button data-store="signatures" class="export-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Xu·∫•t (JSON)</button>
                        <label class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer">Nh·∫≠p (JSON)<input type="file" data-store="signatures" class="import-file-input hidden" accept=".json"></label>
                    </div>
                    <div class="mb-4 p-3 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-secondary))]">
                        <h4 class="font-semibold mb-2">Th√™m ch·ªØ k√Ω m·ªõi</h4>
                        <div class="flex gap-2">
                            <input type="text" id="new-signature-name" placeholder="T√™n c·ªßa b·∫°n" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                            <button id="add-signature-btn" class="bg-indigo-500 hover:bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg">Th√™m</button>
                        </div>
                    </div>
                    <div id="signatures-table" class="text-sm"></div>
                </div>
                <div id="tab-content-placeholders" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω c√°c bi·∫øn gi·ªØ ch·ªó (placeholder) s·ª≠ d·ª•ng trong m·∫´u.</p>
                    <div class="flex gap-2 mb-4">
                        <button data-store="placeholders" class="export-btn bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">Xu·∫•t (JSON)</button>
                        <label class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer">Nh·∫≠p (JSON)<input type="file" data-store="placeholders" class="import-file-input hidden" accept=".json"></label>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="md:col-span-1 h-[60vh] flex flex-col">
                            <h3 class="text-lg font-semibold mb-2">Danh s√°ch Placeholders</h3>
                            <div class="flex-grow overflow-y-auto border border-[rgb(var(--color-border))] rounded-lg p-2 bg-[rgb(var(--color-bg-secondary))]">
                                <button id="add-new-placeholder-btn" class="w-full text-left p-2 rounded-md mb-2 bg-indigo-100 text-indigo-800 font-semibold hover:bg-indigo-200">
                                    + T·∫°o Placeholder M·ªõi
                                </button>
                                <div id="placeholders-list-manager" class="space-y-1"></div>
                            </div>
                        </div>
                        <div class="md:col-span-2">
                            <div id="placeholder-editor-container" class="h-full">
                                 <div class="flex items-center justify-center h-full text-center text-[rgb(var(--color-text-muted))]">
                                     <p>Ch·ªçn m·ªôt placeholder ƒë·ªÉ s·ª≠a, ho·∫∑c t·∫°o m·ªõi.</p>
                                 </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tab-content-suppliers" class="tab-content hidden">
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω d·ªØ li·ªáu nh√† cung c·∫•p. Nh·∫≠p file CSV s·∫Ω <strong class="text-red-600">thay th·∫ø to√†n b·ªô</strong> d·ªØ li·ªáu hi·ªán c√≥.</p>

                    <!-- CSV Import Section -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] border border-[rgb(var(--color-border))] rounded-lg p-4 mb-6">
                        <h4 class="font-semibold mb-3 text-[rgb(var(--color-text-secondary))]">Nh·∫≠p d·ªØ li·ªáu CSV</h4>
                        <div class="flex gap-2 mb-4">
                            <label class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg cursor-pointer transition-colors">
                                üìÅ Ch·ªçn file CSV (Basic)
                                <input type="file" id="import-csv-input" class="hidden" accept=".csv">
                            </label>
                            <a href="csv-import-enhanced.html" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-colors inline-flex items-center">
                                ü§ñ Enhanced CSV Import (AI)
                            </a>
                        </div>

                        <!-- CSV Format Guide -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4">
                            <h5 class="font-medium text-blue-800 mb-2">üìã ƒê·ªãnh d·∫°ng CSV ƒë∆∞·ª£c h·ªó tr·ª£:</h5>
                            <div class="text-sm text-blue-700 space-y-1">
                                <p><strong>Nh√† cung c·∫•p ch√≠nh:</strong> <code>suid,suname</code> (c√≥ th·ªÉ c√≥ th√™m c·ªôt kh√°c)</p>
                                <p><strong>Nh√† cung c·∫•p con:</strong> <code>suchildid,parentSuid</code> (c√≥ th·ªÉ c√≥ th√™m c·ªôt kh√°c)</p>
                                <p class="text-blue-600 mt-2">üí° File CSV c√≥ th·ªÉ ch·ª©a m·ªôt ho·∫∑c c·∫£ hai lo·∫°i d·ªØ li·ªáu</p>
                            </div>
                        </div>

                        <!-- Status Display -->
                        <div id="csv-status-container" class="space-y-2">
                            <div id="csv-feedback" class="text-sm text-[rgb(var(--color-text-secondary))] p-3 bg-gray-50 rounded-lg border"></div>
                            <div id="csv-progress" class="hidden">
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div id="csv-progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                                <p id="csv-progress-text" class="text-xs text-gray-600 mt-1"></p>
                            </div>
                        </div>
                    </div>

                    <!-- Sample CSV Templates -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] border border-[rgb(var(--color-border))] rounded-lg p-4">
                        <h4 class="font-semibold mb-3 text-[rgb(var(--color-text-secondary))]">üìÑ M·∫´u CSV</h4>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div>
                                <h5 class="font-medium text-sm mb-2">Nh√† cung c·∫•p ch√≠nh:</h5>
                                <pre class="bg-gray-100 p-2 rounded text-xs overflow-x-auto">suid,suname
SUP001,C√¥ng ty ABC
SUP002,C√¥ng ty XYZ</pre>
                            </div>
                            <div>
                                <h5 class="font-medium text-sm mb-2">Nh√† cung c·∫•p con:</h5>
                                <pre class="bg-gray-100 p-2 rounded text-xs overflow-x-auto">suchildid,parentSuid
CHILD001,SUP001
CHILD002,SUP001</pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="tab-content-users" class="tab-content hidden">
                    <h3 class="text-lg font-semibold mb-4">Qu·∫£n l√Ω T√†i kho·∫£n User</h3>
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">T·∫°o, ch·ªânh s·ª≠a v√† qu·∫£n l√Ω t√†i kho·∫£n ng∆∞·ªùi d√πng.</p>


                    <!-- User Creation Form -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg mb-6">
                        <h4 class="font-semibold mb-3">T·∫°o t√†i kho·∫£n m·ªõi</h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-1">T√™n t√†i kho·∫£n</label>
                                <input type="text" id="new-user-account" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]" placeholder="Nh·∫≠p t√™n t√†i kho·∫£n">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">T√™n hi·ªÉn th·ªã</label>
                                <input type="text" id="new-user-name" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]" placeholder="Nh·∫≠p t√™n hi·ªÉn th·ªã">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">M·∫≠t kh·∫©u</label>
                                <input type="password" id="new-user-password" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]" placeholder="Nh·∫≠p m·∫≠t kh·∫©u">
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">C·∫•p ƒë·ªô</label>
                                <select id="new-user-level" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                                    <option value="member">Member</option>
                                    <option value="key">Key</option>
                                    <option value="leader">Leader</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-1">Tr·∫°ng th√°i</label>
                                <select id="new-user-status" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-md bg-[rgb(var(--color-bg-primary))]">
                                    <option value="active">Active</option>
                                    <option value="inactive">Inactive</option>
                                </select>
                            </div>
                        </div>
                        <button id="create-user-btn" class="mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">T·∫°o t√†i kho·∫£n</button>
                    </div>

                    <!-- User List -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h4 class="font-semibold mb-3">Danh s√°ch t√†i kho·∫£n</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-[rgb(var(--color-border))]">
                                        <th class="text-left p-2">T√†i kho·∫£n</th>
                                        <th class="text-left p-2">T√™n</th>
                                        <th class="text-left p-2">C·∫•p ƒë·ªô</th>
                                        <th class="text-left p-2">Tr·∫°ng th√°i</th>
                                        <th class="text-left p-2">Thao t√°c</th>
                                    </tr>
                                </thead>
                                <tbody id="users-table-body">
                                    <!-- User rows will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div id="tab-content-kpi" class="tab-content hidden">
                    <h3 class="text-lg font-semibold mb-4">Qu·∫£n l√Ω KPI</h3>
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Qu·∫£n l√Ω ch·ªâ s·ªë KPI theo team, task v√† status.</p>

                    <!-- KPI Filter Section -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg mb-6">
                        <h4 class="font-semibold mb-3">B·ªô l·ªçc KPI</h4>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Team</label>
                                <div id="kpi-team-checkboxes" class="max-h-32 overflow-y-auto border border-[rgb(var(--color-border))] rounded-md p-2 bg-[rgb(var(--color-bg-primary))]">
                                    <!-- Team checkboxes will be populated here -->
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Task</label>
                                <div id="kpi-task-checkboxes" class="max-h-32 overflow-y-auto border border-[rgb(var(--color-border))] rounded-md p-2 bg-[rgb(var(--color-bg-primary))]">
                                    <!-- Task checkboxes will be populated here -->
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Status</label>
                                <div id="kpi-status-checkboxes" class="max-h-32 overflow-y-auto border border-[rgb(var(--color-border))] rounded-md p-2 bg-[rgb(var(--color-bg-primary))]">
                                    <!-- Status checkboxes will be populated here -->
                                </div>
                            </div>
                        </div>
                        <button id="load-kpi-data-btn" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">T·∫£i d·ªØ li·ªáu KPI</button>
                    </div>

                    <!-- KPI Results -->
                    <div class="bg-[rgb(var(--color-bg-secondary))] p-4 rounded-lg">
                        <h4 class="font-semibold mb-3">K·∫øt qu·∫£ KPI</h4>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="border-b border-[rgb(var(--color-border))]">
                                        <th class="text-left p-2">Team</th>
                                        <th class="text-left p-2">Task</th>
                                        <th class="text-left p-2">Status</th>
                                        <th class="text-left p-2">KPI (ticket/mins)</th>
                                        <th class="text-left p-2">Th·ªùi gian t·∫°o</th>
                                        <th class="text-left p-2">Th·ªùi gian c·∫≠p nh·∫≠t</th>
                                        <th class="text-left p-2">Thao t√°c</th>
                                    </tr>
                                </thead>
                                <tbody id="kpi-table-body">
                                    <!-- KPI rows will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                 <div id="tab-content-account" class="tab-content hidden">
                    <h3 class="text-lg font-semibold mb-4">Qu·∫£n l√Ω D·ªØ li·ªáu</h3>
                    <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">T·∫£i d·ªØ li·ªáu m·∫∑c ƒë·ªãnh ho·∫∑c x√≥a t·∫•t c·∫£ d·ªØ li·ªáu ·ª©ng d·ª•ng.</p>
                    <div class="space-y-4">
                        <button id="load-default-data-btn" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg">T·∫£i D·ªØ li·ªáu M·∫∑c ƒë·ªãnh</button>
                        <button id="delete-all-my-data-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg">X√≥a To√†n b·ªô D·ªØ li·ªáu</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Other Modals -->
    <div id="signature-selection-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-sm p-6 transform scale-95">
            <h2 class="text-xl font-bold mb-4">Select Your Signature</h2>
            <p class="text-sm text-[rgb(var(--color-text-muted))] mb-4">Please choose a signature to use for this session.</p>
            <select id="signature-select-dropdown" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></select>
            <div class="mt-6 flex justify-end">
                <button id="signature-confirm-btn" class="bg-[rgb(var(--color-accent-primary))] hover:bg-[rgb(var(--color-accent-primary-hover))] text-white font-bold py-2 px-4 rounded-lg">Confirm</button>
            </div>
        </div>
    </div>
    <div id="import-options-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-md p-6 transform scale-95">
            <h2 class="text-2xl font-bold mb-4 text-blue-600">T√πy ch·ªçn Nh·∫≠p D·ªØ li·ªáu</h2>
            <p class="mb-6 text-[rgb(var(--color-text-secondary))]">B·∫°n mu·ªën l√†m g√¨ v·ªõi d·ªØ li·ªáu t·ª´ file ƒë√£ ch·ªçn?</p>
            <div class="flex justify-end gap-3">
                <button id="import-cancel-btn" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">H·ªßy</button>
                <button id="import-merge-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-lg">G·ªôp (Merge)</button>
                <button id="import-replace-btn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg">Thay th·∫ø (Replace)</button>
            </div>
        </div>
    </div>
    <div id="customer-email-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-40">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-3xl p-6 transform scale-95">
            <h2 class="text-2xl font-bold mb-4 text-rose-600">Nh·∫Øc nh·ªü: G·ª≠i Email cho Customer</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div><label for="customer-email" class="block text-sm font-medium">Email Kh√°ch h√†ng</label><input type="email" id="customer-email" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></div>
                    <div><label for="customer-name" class="block text-sm font-medium">T√™n Kh√°ch h√†ng</label><input type="text" id="customer-name" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></div>
                    <div><label for="customer-order" class="block text-sm font-medium">S·ªë ƒê∆°n h√†ng</label><input type="text" id="customer-order" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></div>
                    <div><label for="customer-brand" class="block text-sm font-medium">Brand</label><select id="customer-brand" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></select></div>
                </div>
                <div class="space-y-4">
                     <h3 class="font-semibold">Th√¥ng tin Email:</h3>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]"><label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">Email ng∆∞·ªùi nh·∫≠n</label><div class="flex items-center gap-2"><p id="customer-email-address-output" class="flex-grow p-2 bg-[rgb(var(--color-bg-primary))] rounded-md text-sm truncate"></p><button id="copy-cust-email-addr-btn" title="Sao ch√©p Email" class="p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></button></div></div>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]"><label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">Ti√™u ƒë·ªÅ</label><div class="flex items-center gap-2"><p id="customer-email-subject-output" class="flex-grow p-2 bg-[rgb(var(--color-bg-primary))] rounded-md text-sm"></p><button id="copy-cust-subject-btn" title="Sao ch√©p Ti√™u ƒë·ªÅ" class="p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></button></div></div>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]"><label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">N·ªôi dung</label><div class="relative"><div id="customer-email-body-output" class="w-full p-2 bg-[rgb(var(--color-bg-primary))] rounded-lg min-h-[150px] text-sm max-h-40 overflow-y-auto"></div><button id="copy-cust-body-btn" title="Sao ch√©p N·ªôi dung" class="absolute top-2 right-2 p-1 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></button></div></div>
                     <div id="customer-copy-feedback" class="h-5 mt-2 text-sm text-green-600 font-medium opacity-0 transition-opacity duration-300">ƒê√£ sao ch√©p!</div>
                </div>
            </div>
            <div class="mt-6 flex justify-end gap-3"><button id="close-customer-modal-btn" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">ƒê√≥ng</button></div>
        </div>
    </div>
    <div id="carrier-email-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-40">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-4xl p-6 transform scale-95">
            <h2 class="text-2xl font-bold mb-4 text-orange-600">Email to Carrier (FMOP)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="space-y-4">
                    <div>
                        <label for="carrier-ticket" class="block text-sm font-medium">Ticket Number</label>
                        <input type="text" id="carrier-ticket" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                    </div>
                    <div>
                        <label for="carrier-po" class="block text-sm font-medium">PO Number</label>
                        <input type="text" id="carrier-po" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                    </div>
                    <div>
                        <label for="carrier-name" class="block text-sm font-medium">Carrier Name</label>
                        <select id="carrier-name" class="mt-1 w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]">
                            <option value="">-- Select Carrier --</option>
                        </select>
                    </div>
                    <div>
                        <label for="carrier-email-address" class="block text-sm font-medium">Carrier Email</label>
                        <div class="flex items-center gap-2">
                            <input type="email" id="carrier-email-address" class="flex-grow p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]" readonly>
                            <button id="copy-carrier-email-btn" title="Copy Email" class="p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="space-y-4">
                    <h3 class="font-semibold">Generated Content:</h3>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]">
                        <label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">Email Subject</label>
                        <div class="flex items-center gap-2">
                            <p id="carrier-email-subject-output" class="flex-grow p-2 bg-[rgb(var(--color-bg-primary))] rounded-md text-sm"></p>
                            <button id="copy-carrier-subject-btn" title="Copy Subject" class="p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]">
                        <label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">BOL File Name</label>
                        <div class="flex items-center gap-2">
                            <p id="carrier-bol-name-output" class="flex-grow p-2 bg-[rgb(var(--color-bg-primary))] rounded-md text-sm"></p>
                            <button id="copy-carrier-bol-btn" title="Copy BOL Name" class="p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="border border-[rgb(var(--color-border))] p-2 rounded-lg bg-[rgb(var(--color-bg-secondary))]">
                        <label class="block text-xs font-medium text-[rgb(var(--color-text-muted))] mb-1">Email Content</label>
                        <div class="relative">
                            <div id="carrier-email-body-output" class="w-full p-2 bg-[rgb(var(--color-bg-primary))] rounded-lg min-h-[150px] text-sm max-h-40 overflow-y-auto"></div>
                            <button id="copy-carrier-body-btn" title="Copy Content" class="absolute top-2 right-2 p-1 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="carrier-copy-feedback" class="h-5 mt-2 text-sm text-green-600 font-medium opacity-0 transition-opacity duration-300">Copied!</div>
                </div>
            </div>
            <div class="mt-6 flex justify-end gap-3">
                <button id="close-carrier-modal-btn" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">Close</button>
            </div>
        </div>
    </div>
    <div id="validation-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-md p-6 transform scale-95"><h2 class="text-2xl font-bold mb-4 text-yellow-600">C·∫£nh b√°o</h2><p class="mb-4">Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß c√°c tr∆∞·ªùng th√¥ng tin b·∫Øt bu·ªôc sau:</p><ul id="missing-fields-list" class="list-disc list-inside text-[rgb(var(--color-text-muted))] mb-6"></ul><div class="flex justify-end"><button id="close-validation-modal-btn" class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-lg">ƒê√£ hi·ªÉu</button></div></div>
    </div>
    <div id="label-reminder-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-md p-6 transform scale-95"><h2 class="text-2xl font-bold mb-4 text-[rgb(var(--color-accent-primary))]">Nh·∫Øc nh·ªü</h2><p id="label-reminder-text" class="mb-6"></p><div class="flex justify-end"><button id="close-label-reminder-modal-btn" class="bg-[rgb(var(--color-accent-primary))] hover:bg-[rgb(var(--color-accent-primary-hover))] text-white font-bold py-2 px-4 rounded-lg">OK</button></div></div>
    </div>
    <div id="internal-comment-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-xl p-6 transform scale-95"><h2 class="text-2xl font-bold mb-4">Nh·∫Øc nh·ªü: Sao ch√©p Comment n·ªôi b·ªô</h2><div class="relative"><div id="internal-comment-output" class="w-full p-3 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-secondary))] min-h-[150px] text-sm max-h-60 overflow-y-auto"></div><button id="copy-internal-comment-btn" title="Sao ch√©p N·ªôi dung" class="absolute top-2 right-2 p-2 bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] rounded-md"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" /></svg></button></div><div id="internal-comment-copy-feedback" class="h-5 mt-2 text-sm text-green-600 font-medium opacity-0">ƒê√£ sao ch√©p!</div><div class="mt-6 flex justify-end"><button id="close-internal-comment-modal-btn" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">ƒê√≥ng</button></div></div>
    </div>
    <div id="movement-guide-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-2xl p-6 transform scale-95"><h2 class="text-2xl font-bold mb-4 text-purple-700">H∆∞·ªõng d·∫´n Quy tr√¨nh Move Ticket</h2><div id="movement-guide-output" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2"></div><div class="mt-6 flex justify-end"><button id="close-movement-guide-modal-btn" class="bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg">ƒê√£ hi·ªÉu</button></div></div>
    </div>
     <div id="follow-up-guide-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-2xl p-6 transform scale-95"><h2 class="text-2xl font-bold mb-4 text-cyan-700">C√°c b∆∞·ªõc Follow-up B·∫Øt bu·ªôc</h2><div id="follow-up-guide-output" class="space-y-4 max-h-[60vh] overflow-y-auto pr-2"></div><div class="mt-6 flex justify-end"><button id="close-follow-up-guide-modal-btn" class="bg-cyan-500 hover:bg-cyan-600 text-white font-bold py-2 px-4 rounded-lg">ƒê√£ hi·ªÉu</button></div></div>
    </div>
    <div id="help-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-4xl h-[90vh] p-6 transform scale-95 flex flex-col">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">Tr·ª£ gi√∫p & H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h2>
                <button id="close-help-modal-btn" class="p-2 rounded-full hover:bg-[rgb(var(--color-bg-secondary))]">&times;</button>
            </div>
            <div id="help-content" class="prose dark:prose-invert max-w-none flex-grow overflow-y-auto pr-4">
            </div>
        </div>
    </div>
    <div id="component-select-modal" class="modal-backdrop fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden opacity-0 z-50">
        <div class="modal-content bg-[rgb(var(--color-bg-primary))] rounded-lg shadow-xl w-full max-w-sm p-6 transform scale-95">
            <h2 id="component-modal-title" class="text-xl font-bold mb-4">Select Placeholder</h2>
            <select id="component-modal-select" class="w-full p-2 border border-[rgb(var(--color-border))] rounded-lg bg-[rgb(var(--color-bg-primary))]"></select>
            <div class="mt-6 flex justify-end gap-3">
                <button id="component-modal-cancel" class="bg-[rgb(var(--color-bg-tertiary))] hover:bg-[rgb(var(--color-border))] text-[rgb(var(--color-text-secondary))] font-bold py-2 px-4 rounded-lg">Cancel</button>
                <button id="component-modal-confirm" class="bg-[rgb(var(--color-accent-primary))] hover:bg-[rgb(var(--color-accent-primary-hover))] text-white font-bold py-2 px-4 rounded-lg">Confirm</button>
            </div>
        </div>
    </div>
    <script src="./js/adminview.js"></script>
</body>
</html>

